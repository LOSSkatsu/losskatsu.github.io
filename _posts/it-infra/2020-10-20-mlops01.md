---
title: "[MLOps] 도커, 쿠버네티스 설치 및 환경 설정" 
categories:
  - it-infra
tags:
  - it-infra
use_math: true
toc: true
toc_label: "My Table of Contents"
toc_icon: "cog"
sidebar:
  title: "AI Machine Learning"
  nav: sidebar-contents
---

# 머신러닝 엔지니어를 위한 도커, 쿠버네티스 설치 및 환경 설정

## 1. 서버 세팅

### 1.1. 주어진 서버 확인

사설IP | 공인IP | ssh포트 
-------|--------|---------
111.11.1.111 | 222.222.222.22 | 22 
333.33.3.333 | 444.444.444.44 | 23

위와 같이 서버 두 대가 주어졌다고 하겠습니다. 
111.11.1.111 서버를 마스터(master), 333.33.3.333 서버를 워커(worker)노드라고 하겠습니다. 

### 1.2. 서버 접속

### 1.2.1. 마스터 접속

```bash
$ ssh root@222.22.222.22
```

초기 사용자명은 root입니다.

### 1.2.2. 워커 접속

```bash
$ ssh root@444.444.444.44 -p 23
```

워커는 포트까지 입력해줍시다.

### 1.3. 사용자 추가(마스터, 워커 공통)

root 계정을 그대로 사용하기는 좀 그러니 사용자를 추가하겠습니다. 
유저 이름은 openup 이라고 하겠습니다. 

```bash
$ adduser openup
```

그리고 아래와 같이 sudoers를 vim으로 열어줍니다.

```bash
$ vim /etc/sudoers
```

그리고 아래와 같은 문법으로 슈퍼유저 권한을 추가해줍니다.

```
유저이름   ALL=(ALL:ALL) ALL
```

이를 적용하면 

```vim
openup   ALL=(ALL:ALL) ALL
```

그리고 openup 유저로 다음과 같이 변경 가능합니다. 


```bash
$ su - openup
```

### 1.4. 디스크 파티션 생성 및 포맷(마스터, 워커 공통)

```bash
$ sudo fdisk -l
$ sudo fdisk /dev/xvdb
```

n : 파티션 생성  

default setting  

w : 저장  

```bash
$ mkfs.ext4 /dev/xvdb1
```

### 1.5. 파티션 마운트(마스터, 워커 공통)

```bash
$ mkdir -p /mnt/storage
$ sudo nano /etc/fstab
```
```
UUID=파티션의UUID /mnt/storage ext4 defaults 0 0
```

```bash
$ sudo mount -a
$ sudo chmod 777 /mnt/storage

# 확인
$ df -h
```
