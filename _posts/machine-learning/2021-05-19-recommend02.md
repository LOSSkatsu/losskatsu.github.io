---
title: "[추천시스템] 추천시스템(2) - Neighborhood based collaborative filtering" 
categories:
  - machine-learning
tags:
  - machine-learning
use_math: true
toc: true
toc_label: "My Table of Contents"
toc_icon: "cog"
sidebar:
  title: "AI Machine Learning"
  nav: sidebar-contents
---

# 추천시스템(2) - Neighborhood based collaborative filtering

본 포스팅은  Aggarwal의 recommender system을 참고했습니다. 

## 1. 서론

Neighborhood based collaborative filtering 알고리즘은 다른 말로 memory-based algorithm이라고도 부릅니다. 
이 알고리즘은 비슷한 유저는 특정 아이템에 비슷한 평점을 준다는 아이디어에 기반합니다. 
Neighborhood based collaborative filtering는 두가지 타입이 존재합니다.

### 1.1 User-based collaborative filtering  

이 경우에는, 유저 A와 비슷한 유저들의 평점이 유저 A의 추천에 사용됩니다. 
유저 A의 각 아이템의 예측 평점은 유저 A가 속하는 동료 집단(peer)의 평점으로 계산됩니다. 

* 평점을 예측할 때 이웃 유저를 이용해서 예측함
* 여기서 이웃이란 비슷한 유저를 의미함(평점 행렬의 행)

### 1.2 Item-based collaborative filtering  

타겟 아이템 B에 대해 추천을 하기위한 첫번째 단계는 아이템 B와 비슷한 집단 S를 설정하는 것입니다. 
그리고 나서 유저 A에 대해 아이템 B의 평점을 예측하기 위해 집단 S에 속하는 아이템 중 유저 A가 매겻던 아이템의 평점을 이용하는 것입니다. 
집단 S에 속하는 아이템 중 유저 A가 과거에 평점을 매겼던 아이템이 있다면 
이 아이템들의 가중 평균을 구해서 유저 A의 아이템 B의 평점을 예측하는 것입니다.

* 해당 유저가 과거 평점을 매겼던 이웃 아이템을 대상으로 예측
* 여기서 이웃이란 비슷한 아이템을 의미함(평점 행렬의 열)

### 1.3 평점 행렬

이번엔 $m \times n$ 평점 행렬(rating matrix) R에 대해 이야기 해보겠습니다. 
이 평점 행렬 R은  m명의 유저와 n개의 아이템을 포함합니다. 
 Neighborhood based collaborative filtering은 다음 두 가지 방법 중하나로 표현됩니다. 
 
 (1) user-item 조합의 평점 예측  
 
 이는 추천시스템에서 간단하고 가장 기본적인 부분입니다. 이 경우 아직 평점이 매겨지지 않은 값을 예측합니다. 
 예를 들어, 유저 u의 아이템 j인 $r_{uj}$를 예측하는 것입니다. 
 
 (2) top k 아이템 혹은 top k 유저 결정  
 
 사실 물건을 파는 사람 입장에서는 user-item 조합의 평점 리스트를 보는게 필수는 아닙니다. 
 그보다는 특정 유저가 흥미 있어할 법한 top k 아이템을 보고 싶어할 것입니다. 
 혹은  특정 아이템에 대해 가장 관련 있을 법한 top k 유저를 보고 싶어할 것입니다. 
 둘 중 더 일반적인 것은 top k 아이템 선정입니다. 
 예전에는 top k 아이템이 더 일반적이었지만 시간이 지나면서 마케팅에 사용하기 위해 top k 유저도 유용해지고 있습니다. 
 
 ## 2. 평점 행렬의 성질
 
 
 
